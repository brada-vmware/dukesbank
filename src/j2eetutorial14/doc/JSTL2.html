<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <title>The Example JSP Pages</title>
    <link rel="StyleSheet" href="document.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="catalog.css" type="text/css" media="all" />
    <link rel="Table of Contents" href="J2EETutorialTOC.html" />
    <link rel="Previous" href="JSTL.html" />
    <link rel="Next" href="JSTL3.html" />
    <link rel="Index" href="J2EETutorialIX.html" />

		<!--[if gte IE 5.5000]>
		<script language="JavaScript">
			function correctPNG() { // correctly handle PNG transparency in Win IE 5.5 or higher.
				for(var i=0; i<document.images.length; i++) {
	  			var img = document.images[i]
	  			var imgName = img.src.toUpperCase()
	  			if (imgName.substring(imgName.length-3, imgName.length) == "PNG") {
						var imgID = (img.id) ? "id='" + img.id + "' " : ""
		 				var imgClass = (img.className) ? "class='" + img.className + "' " : ""
		 				var imgTitle = (img.title) ? "title='" + img.title + "' " : "title='" + img.alt + "' "
		 				var imgStyle = "display:inline-block;" + img.style.cssText
		 				if (img.align == "left") imgStyle = "float:left;" + imgStyle
		 				if (img.align == "right") imgStyle = "float:right;" + imgStyle
		 				if (img.parentElement.href) imgStyle = "cursor:hand;" + imgStyle
		 				var strNewHTML = "<span " + imgID + imgClass + imgTitle
		 				+ " style=\"" + "width:" + img.width + "px; height:" + img.height + "px;" + imgStyle + ";"
	     			+ "filter:progid:DXImageTransform.Microsoft.AlphaImageLoader"
		 				+ "(src=\'" + img.src + "\', sizingMethod='scale');\"></span>"
		 				img.outerHTML = strNewHTML
		 				i = i-1
	    		}
      	}
   		}
			window.attachEvent("onload", correctPNG);
		</script>
		<![endif]-->
  </head>

  <body>
		<div id="header">
			<img src="images/tutorialTitle.png" width="154" height="50" alt="The J2EE(TM) 1.4 Tutorial"/>
			<div class="navigation">
				<a accesskey="p" href="JSTL.html" title="Previous"><img id="LongDescNotReq1" src="images/previous.png" width="40" height="40" border="0" alt="Prev" /></a><a accesskey="c" href="J2EETutorialFront.html" title="Beginning"><img id="LongDescNotReq1" src="images/up.png" width="40" height="40" border="0" alt="Beginning" /></a><a accesskey="n" href="JSTL3.html" title="Next"><img id="LongDescNotReq3" src="images/next.png" width="40" height="40" border="0" alt="Next" /></a>
			</div>
			<div id="header-links">
				<a href="index.html" target="_blank">Home</a> | <a href="http://java.sun.com/j2ee/1.4/download.html#tutorial" target="_blank">Download</a> | <a href="J2EETutorial.pdf" target="_blank">PDF</a> | <a href="http://java.sun.com/j2ee/1.4/docs/api/index.html" target="_blank">API</a> | <a href="http://java.sun.com/j2ee/1.4/docs/tutorial/information/faq.html" target="_blank">FAQ</a> | <a href="http://java.sun.com/j2ee/1.4/docs/tutorial/information/search.html" target="_blank">Search</a> | <a href="http://java.sun.com/j2ee/1.4/docs/tutorial/information/sendusmail.html" target="_blank">Feedback</a> | <a href="http://java.sun.com/j2ee/1.4/docs/tutorial/information/history.html" target="_blank">History</a>
			</div>
		</div>

    <blockquote>
<a name="wp83467"> </a><h2 class="pHeading1">
The Example JSP Pages
</h2>
<a name="wp83469"> </a><p class="pBody">
This chapter illustrates JSTL using excerpts from the JSP version of the Duke's Bookstore application discussed in Chapter <a  href="JSPIntro.html#wp65706">12</a>. Here, they are rewritten to replace the JavaBeans component database access object with direct calls to the database via the JSTL SQL tags. For most applications, it is better to encapsulate calls to a database in a bean. JSTL includes SQL tags for situations where a new application is being prototyped and the overhead of creating a bean may not be warranted.
</p>
<a name="wp82073"> </a><p class="pBody">
The source for the Duke's Bookstore application is located in the <code class="cCode">&lt;</code><code class="cVariable">INSTALL</code><code class="cCode">&gt;/j2eetutorial14/examples/web/bookstore4/</code> directory created when you unzip the tutorial bundle (see <a  href="About.html#wp85042">About the Examples</a>). A sample <code class="cCode">bookstore4.war</code> is provided in <code class="cCode">&lt;</code><code class="cVariable">INSTALL</code><code class="cCode">&gt;/j2eetutorial14/examples/web/provided-wars/</code>. To build the example, follow these steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp86856"> </a><div class="pSmartList1"><li>Build and package the bookstore common files as described in <a  href="WebApp5.html#wp189559">Duke's Bookstore Examples</a>. </li></div>
<a name="wp86367"> </a><div class="pSmartList1"><li>In a terminal window, go to <code class="cCode">&lt;</code><code class="cVariable">INSTALL</code><code class="cCode">&gt;/j2eetutorial14/examples/web/bookstore4/</code>.</li></div>
<a name="wp86999"> </a><div class="pSmartList1"><li>Run <code class="cCode">asant</code> <code class="cCode">build</code>. This target will copy files to the <code class="cCode">&lt;</code><code class="cVariable">INSTALL</code><code class="cCode">&gt;/j2eetutorial14/examples/web/bookstore4/build/</code> directory. </li></div>
<a name="wp87000"> </a><div class="pSmartList1"><li>Start the Application Server.</li></div>
<a name="wp87003"> </a><div class="pSmartList1"><li>Perform all the operations described in <a  href="WebApp6.html#wp69868">Accessing Databases from Web Applications</a>.</li></div>
</ol></div>
<a name="wp91212"> </a><p class="pBody">
To package and deploy the example using <code class="cCode">asant</code>, follow these steps:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp91213"> </a><div class="pSmartList1"><li>Run <code class="cCode">asant</code> <code class="cCode">create-bookstore-war</code>.</li></div>
<a name="wp91214"> </a><div class="pSmartList1"><li>Run <code class="cCode">asant</code> <code class="cCode">deploy-war</code>.</li></div>
</ol></div>
<a name="wp91220"> </a><p class="pBody">
To learn how to configure the example, use <code class="cCode">deploytool</code> to package and deploy it:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp90373"> </a><div class="pSmartList1"><li>Start <code class="cCode">deploytool</code>.</li></div>
<a name="wp90374"> </a><div class="pSmartList1"><li>Create a web application called <code class="cCode">bookstore4</code> by running the New Web Component wizard. Select File<span style="font-family: Symbol"><img src="images/arrwrite.gif" border="0" alt="Right Arrow"></span>New<span style="font-family: Symbol"><img src="images/arrwrite.gif" border="0" alt="Right Arrow"></span>Web Component.</li></div>
<a name="wp90375"> </a><div class="pSmartList1"><li>In the New Web Component wizard:</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp90376"> </a><div class="pSmartList2"><li>Select the Create New Stand-Alone WAR Module radio button.</li></div>
<a name="wp90377"> </a><div class="pSmartList2"><li>In the WAR File field, enter <code class="cCode">&lt;</code><code class="cVariable">INSTALL</code><code class="cCode">&gt;/j2eetutorial14/examples/web/bookstore4/bookstore4.war</code>. The WAR Display Name field will show <code class="cCode">bookstore4</code>.</li></div>
<a name="wp90379"> </a><div class="pSmartList2"><li>In the Context Root field, enter <code class="cCode">/bookstore4</code>.</li></div>
<a name="wp90380"> </a><div class="pSmartList2"><li>Click Edit Contents. </li></div>
<a name="wp90381"> </a><div class="pSmartList2"><li>In the Edit Contents dialog box, navigate to <code class="cCode">&lt;</code><code class="cVariable">INSTALL</code><code class="cCode">&gt;/j2eetutorial14/examples/web/bookstore4/build</code>/. Select the JSP pages <code class="cCode">bookstore.jsp</code>, <code class="cCode">bookdetails.jsp</code>, <code class="cCode">bookcatalog.jsp</code>, <code class="cCode">bookshowcart.jsp</code>, <code class="cCode">bookcashier.jsp</code>, and <code class="cCode">bookreceipt.jsp</code> and the <code class="cCode">template</code> directory and click Add. </li></div>
<a name="wp90382"> </a><div class="pSmartList2"><li>Add the shared bookstore library. Navigate to<code class="cCode"> &lt;</code><code class="cVariable">INSTALL</code><code class="cCode">&gt;/j2eetutorial14/examples/web/bookstore/dist/</code>. Select <code class="cCode">bookstore.jar</code> and click Add.</li></div>
<a name="wp90383"> </a><div class="pSmartList2"><li>Click OK.</li></div>
<a name="wp90384"> </a><div class="pSmartList2"><li>Click Next.</li></div>
<a name="wp90385"> </a><div class="pSmartList2"><li>Select the JSP Page radio button. </li></div>
<a name="wp90386"> </a><div class="pSmartList2"><li>Click Next.</li></div>
<a name="wp90387"> </a><div class="pSmartList2"><li>Select /<code class="cCode">bookstore.jsp</code> from the JSP Filename combo box. </li></div>
<a name="wp90390"> </a><div class="pSmartList2"><li>Click Finish.</li></div>
</ol></div>
<a name="wp91538"> </a><div class="pSmartList1"><li>Add the alias for the bookstore.jsp component:</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp91539"> </a><div class="pSmartList2"><li>Select the bookstore web component.</li></div>
<a name="wp91540"> </a><div class="pSmartList2"><li>Select the Aliases tab.</li></div>
<a name="wp91541"> </a><div class="pSmartList2"><li>Click Add.</li></div>
<a name="wp91542"> </a><div class="pSmartList2"><li>Enter <code class="cCode">/bookstore</code> into the Aliases table.</li></div>
</ol></div>
<a name="wp90394"> </a><div class="pSmartList1"><li>Add each of the web components listed in <a  href="JSTL2.html#wp90407">Table 14-1</a>. For each component:</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp90395"> </a><div class="pSmartList2"><li>Select File<span style="font-family: Symbol"><img src="images/arrwrite.gif" border="0" alt="Right Arrow"></span>New<span style="font-family: Symbol"><img src="images/arrwrite.gif" border="0" alt="Right Arrow"></span>Web Component.</li></div>
<a name="wp90396"> </a><div class="pSmartList2"><li>Click the Add to Existing WAR Module radio button. Because the WAR contains all the JSP pages, you do not have to add any more content.</li></div>
<a name="wp90397"> </a><div class="pSmartList2"><li>Click Next.</li></div>
<a name="wp90398"> </a><div class="pSmartList2"><li>Select the JSP Page radio button. </li></div>
<a name="wp90399"> </a><div class="pSmartList2"><li>Click Next.</li></div>
<a name="wp90400"> </a><div class="pSmartList2"><li>Select the page from the JSP Filename combo box. </li></div>
<a name="wp90448"> </a><div class="pSmartList2"><li>Click Finish.<div align="left">
<table border="1" id="wp90407">
  <caption><a name="wp90407"> </a><div class="pTableTitle">
Table 14-1   Duke's Bookstore Web Components&nbsp;
</div>
</caption>
  <tr align="center">    <th><a name="wp90413"> </a><div class="pCellHeading">
Web Component Name
</div>
</th>
    <th><a name="wp90415"> </a><div class="pCellHeading">
JSP Page
</div>
</th>
    <th><a name="wp90417"> </a><div class="pCellHeading">
Alias
</div>
</th>
</tr>
  <tr align="left">    <td><a name="wp90419"> </a><div class="pCellBody">
<code class="cCode">bookcatalog</code>
</div>
</td>
    <td><a name="wp90421"> </a><div class="pCellBody">
<code class="cCode">bookcatalog.jsp</code>
</div>
</td>
    <td><a name="wp90423"> </a><div class="pCellBody">
<code class="cCode">/bookcatalog</code>
</div>
</td>
</tr>
  <tr align="left">    <td><a name="wp90425"> </a><div class="pCellBody">
<code class="cCode">bookdetails</code>
</div>
</td>
    <td><a name="wp90427"> </a><div class="pCellBody">
<code class="cCode">bookdetails.jsp</code>
</div>
</td>
    <td><a name="wp90429"> </a><div class="pCellBody">
<code class="cCode">/bookdetails</code>
</div>
</td>
</tr>
  <tr align="left">    <td><a name="wp90431"> </a><div class="pCellBody">
<code class="cCode">bookshowcart</code>
</div>
</td>
    <td><a name="wp90433"> </a><div class="pCellBody">
<code class="cCode">bookshowcart.jsp</code>
</div>
</td>
    <td><a name="wp90435"> </a><div class="pCellBody">
<code class="cCode">/bookshowcart</code>
</div>
</td>
</tr>
  <tr align="left">    <td><a name="wp90437"> </a><div class="pCellBody">
<code class="cCode">bookcashier</code>
</div>
</td>
    <td><a name="wp90439"> </a><div class="pCellBody">
<code class="cCode">bookcashier.jsp</code>
</div>
</td>
    <td><a name="wp90441"> </a><div class="pCellBody">
<code class="cCode">/bookcashier</code>
</div>
</td>
</tr>
  <tr align="left">    <td><a name="wp90443"> </a><div class="pCellBody">
<code class="cCode">bookreceipt</code>
</div>
</td>
    <td><a name="wp90445"> </a><div class="pCellBody">
<code class="cCode">bookreceipt.jsp</code>
</div>
</td>
    <td><a name="wp90447"> </a><div class="pCellBody">
<code class="cCode">/bookreceipt</code>
</div>
</td>
</tr>
</table>
</div>
</li></div>
</ol></div>
<a name="wp90449"> </a><div class="pSmartList1"><li>Set the alias for each web component.</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp90450"> </a><div class="pSmartList2"><li>Select the component.</li></div>
<a name="wp90451"> </a><div class="pSmartList2"><li>Select the Aliases tab.</li></div>
<a name="wp90452"> </a><div class="pSmartList2"><li>Click the Add button.</li></div>
<a name="wp90453"> </a><div class="pSmartList2"><li>Enter the alias.</li></div>
</ol></div>
<a name="wp91053"> </a><div class="pSmartList1"><li>Add the context parameter that specifies the JSTL resource bundle base name.</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp90455"> </a><div class="pSmartList2"><li>Select the web module.</li></div>
<a name="wp90456"> </a><div class="pSmartList2"><li>Select the Context tab. </li></div>
<a name="wp90457"> </a><div class="pSmartList2"><li>Click Add.</li></div>
<a name="wp90458"> </a><div class="pSmartList2"><li>Enter <code class="cCode">javax.servlet.jsp.jstl.fmt.localizationContext</code> in the Coded Parameter field.</li></div>
<a name="wp90459"> </a><div class="pSmartList2"><li>Enter <code class="cCode">messages.BookstoreMessages</code> in the Value field.</li></div>
</ol></div>
<a name="wp90460"> </a><div class="pSmartList1"><li>Set the prelude and coda for all JSP pages.</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp90461"> </a><div class="pSmartList2"><li>Select the JSP Properties tab.</li></div>
<a name="wp90462"> </a><div class="pSmartList2"><li>Click the Add button next to the Name list.</li></div>
<a name="wp90463"> </a><div class="pSmartList2"><li>Enter <code class="cCode">bookstore4</code>.</li></div>
<a name="wp90464"> </a><div class="pSmartList2"><li>Click the Add URL button.</li></div>
<a name="wp90465"> </a><div class="pSmartList2"><li>Enter <code class="cCode">*.jsp</code>.</li></div>
<a name="wp90466"> </a><div class="pSmartList2"><li>Click the Edit Preludes button.</li></div>
<a name="wp90467"> </a><div class="pSmartList2"><li>Click Add.</li></div>
<a name="wp90468"> </a><div class="pSmartList2"><li>Enter <code class="cCode">/template/prelude.jspf</code>.</li></div>
<a name="wp90469"> </a><div class="pSmartList2"><li>Click OK.</li></div>
<a name="wp90470"> </a><div class="pSmartList2"><li>Click the Edit Codas button.</li></div>
<a name="wp90471"> </a><div class="pSmartList2"><li>Click Add.</li></div>
<a name="wp90472"> </a><div class="pSmartList2"><li>Enter <code class="cCode">/template/coda.jspf</code>.</li></div>
<a name="wp90473"> </a><div class="pSmartList2"><li>Click OK.</li></div>
</ol></div>
<a name="wp90475"> </a><div class="pSmartList1"><li>Add a resource reference for the database.</li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp90476"> </a><div class="pSmartList2"><li>Select the Resource Ref's tab.</li></div>
<a name="wp90477"> </a><div class="pSmartList2"><li>Click Add.</li></div>
<a name="wp90478"> </a><div class="pSmartList2"><li>Enter <code class="cCode">jdbc/BookDB</code> in the Coded Name field.</li></div>
<a name="wp90479"> </a><div class="pSmartList2"><li>Accept the default type <code class="cCode">javax.sql.DataSource</code>.</li></div>
<a name="wp90480"> </a><div class="pSmartList2"><li>Accept the default authorization <code class="cCode">Container</code>.</li></div>
<a name="wp90481"> </a><div class="pSmartList2"><li>Accept the default selected <code class="cCode">Shareable</code>.</li></div>
<a name="wp90482"> </a><div class="pSmartList2"><li>Enter <code class="cCode">jdbc/BookDB</code> in the JNDI name field of the Sun-specific Settings frame.</li></div>
</ol></div>
<a name="wp90483"> </a><div class="pSmartList1"><li>Select File<span style="font-family: Symbol"><img src="images/arrwrite.gif" border="0" alt="Right Arrow"></span>Save.</li></div>
<a name="wp90484"> </a><div class="pSmartList1"><li>Deploy the application. </li></div>
<div class="pSmartList2"><ol type="a" class="pSmartList2">
<a name="wp90485"> </a><div class="pSmartList2"><li>Select Tools<span style="font-family: Symbol"><img src="images/arrwrite.gif" border="0" alt="Right Arrow"></span>Deploy. </li></div>
<a name="wp90486"> </a><div class="pSmartList2"><li>Click OK.</li></div>
</ol></div>
</ol></div>
<a name="wp75367"> </a><p class="pBody">
To run the application, open the bookstore URL <code class="cCode">http://localhost:8080/bookstore4/bookstore</code>.
</p>
<a name="wp66163"> </a><p class="pBody">
See <a  href="Servlets3.html#wp71209">Troubleshooting</a> for help with diagnosing common problems.
</p>
    </blockquote>

		<div id="footer">

			<div class="navigation">
				<a accesskey="p" href="JSTL.html" title="Previous"><img id="LongDescNotReq1" src="images/previous.png" width="40" height="40" border="0" alt="Prev" /></a><a accesskey="c" href="J2EETutorialFront.html" title="Beginning"><img id="LongDescNotReq1" src="images/up.png" width="40" height="40" border="0" alt="Beginning" /></a><a accesskey="n" href="JSTL3.html" title="Next"><img id="LongDescNotReq3" src="images/next.png" width="40" height="40" border="0" alt="Next" /></a>
			</div>

			<div id="copyright">
				<p>All of the material in <em>The J2EE(TM) 1.4 Tutorial</em> is <a href="J2EETutorialFront2.html">copyright</a>-protected and may not be published in other works without express written permission from Sun Microsystems.</p>
			</div>
		</div>

  </body>
</html>
